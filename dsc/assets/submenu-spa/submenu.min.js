"use strict";(function(){var dir,path,hash;"/tw/dsc/assets/submenu-spa/demo.html"===location.pathname?(dir="",path="/tw/dsc/solution/mobile/WB002839/index#/merchandise".split("/"),hash=""):(dir="/tw/dsc/assets/submenu-spa/",path=location.pathname.split("/"));var id=path.find(function(value){return value.startsWith("WB")}),page="#/"+path[path.length-1].replace(/(.html|.htm)/g,""),header=document.querySelector(".header-box header");null===header||new Vue({el:"#submenu",data:{results:[],currentPage:"",activeIndex:0,isActive:!1},computed:{submenu:function submenu(){return document.querySelector(".page-submenu")}},created:function created(){header.insertAdjacentHTML("beforeend","<div id=\"submenu\"></div>"),this.getData()},mounted:function mounted(){var _this=this;document.querySelector("body").addEventListener("touchstart",function(event){return _this.closeDropdownHandler(event)})},beforeDestroy:function beforeDestroy(){document.querySelector("body").removeEventListener("touchstart"),window.removeEventListener("scroll",this.scrollHandler),window.removeEventListener("resize",this.resizeHandler)},methods:{getData:function getData(){var _this2=this;fetch("".concat(dir,"submenu.json")).then(function(res){return res.json()}).then(function(res){_this2.results=res.filter(function(value){return value.id===id});_this2.results.length&&(_this2.setActiveIndex(),_this2.isActive=!0,window.addEventListener("load",_this2.resizeHandler),window.addEventListener("resize",_this2.resizeHandler),_this2.results[0].anchors&&window.addEventListener("scroll",_this2.scrollHandler))})},setCurrentPage:function setCurrentPage(text){this.currentPage=text&&!text.match(/首頁$/)?text:""},setActiveIndex:function setActiveIndex(){var _this3=this;this.results[0].menus.some(function(menu,index){return menu.url===page?(_this3.activeIndex=index,_this3.setCurrentPage(menu.text),!0):menu.dropdowns?menu.dropdowns.some(function(dropdown){if(dropdown.url===page)return _this3.activeIndex=index,_this3.setCurrentPage(dropdown.text),!0}):void 0})},setTitle:function setTitle(value){return this.currentPage?"".concat(value," / ").concat(this.currentPage):value},getScrollPos:function getScrollPos(el,offset,callback){if($(el).length){var scrollTop=$(window).scrollTop(),target=$(el).offset().top-offset;scrollTop>=target&&callback()}},scrollHandler:function scrollHandler(){var _this4=this,anchors=this.results[0].anchors,offset=this.submenu.offsetHeight;anchors.forEach(function(item){_this4.getScrollPos(item.url,offset,function(){$(_this4.submenu).addClass("active").find(".page-submenu-list > li").removeClass("active").eq(item.index).addClass("active")})})},linkTo:function linkTo(_ref){var _this5=this,url=_ref.url,target=_ref.target,anchor=_ref.anchor;if(target)window.open("".concat(url),target);else if(url&&!anchor)window.open("".concat(url),"_self"),this.setPageInfo(url),"javascript:;"!==url&&this.closeDropdownHandler();else if(!url&&anchor){var targetPos=$(anchor).offset().top,offset=document.querySelector("html").classList.contains("production")&&$(".page-submenu").outerHeight(),finalPos=offset?targetPos-offset:targetPos;$("html, body").animate({scrollTop:finalPos}),this.closeDropdownHandler()}else url&&anchor&&(window.open("".concat(url),"_self"),setTimeout(function(){var targetPos=$(anchor).offset().top,offset=$(".page-submenu").outerHeight();$("html, body").animate({scrollTop:targetPos-offset}),_this5.closeDropdownHandler()},2e3),this.setPageInfo(url))},setPageInfo:function setPageInfo(url){"javascript:;"===url||(page=url,this.setActiveIndex())},openDropdown:function openDropdown(event){$(event.target).parents("li").addClass("is-open").siblings().removeClass("is-open")},closeDropdownHandler:function closeDropdownHandler(event){event&&1===$(event.target).parents(".page-submenubox").length||$(".page-submenu-list > li").removeClass("is-open")},resizeHandler:function resizeHandler(){var menuHeight=this.submenu.offsetHeight,main=document.querySelector("main");null===main||(main.style.paddingTop=50<menuHeight?"50px":0)}},template:"\n            <div class=\"page-submenubox\" :class=\"{active:isActive}\">\n                <div class=\"page-submenu\">\n                    <div class=\"container\">\n                        <template v-for=\"result in results\">\n                            <h2>{{setTitle(result.title)}}</h2>\n                            <ul class=\"page-submenu-list\">\n                                <li v-for=\"(menu, index) in result.menus\">\n                                    <span :class=\"{active:index===activeIndex}\">\n                                        <a :href=\"menu.url\" @click.prevent=\"linkTo(menu)\" @touchstart=\"openDropdown\">{{menu.text}}</a>\n                                    </span>\n                                    <ul v-if=\"menu.dropdowns\" class=\"page-submenu-dropdown\">\n                                        <li v-for=\"dropdown in menu.dropdowns\">\n                                            <a :href=\"dropdown.url\" @click.prevent=\"linkTo(dropdown)\">{{dropdown.text}}</a>\n                                        </li>\n                                    </ul>\n                                </li>\n                            </ul>\n                        </template>\n                    </div>\n                </div>\n            </div>\n        "})})();
