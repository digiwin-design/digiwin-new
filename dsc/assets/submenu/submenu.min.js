"use strict";(function(){var dir,path,hash;"/tw/dsc/assets/submenu/demo.html"===location.pathname?(dir="",path="/tw/dsc/solution/WB002554/WB00255401_Issue".split("/"),hash="#contact"):(dir="/tw/dsc/assets/submenu/",path=location.pathname.split("/"),hash=location.hash);var id=path[path.length-2],page=path[path.length-1].replace(/(.html|.htm)/g,""),header=document.querySelector(".header-box header");null===header||new Vue({el:"#submenu",data:{results:[],currentPage:"",activeIndex:0,isActive:!1},computed:{submenu:function submenu(){return document.querySelector(".page-submenu")}},created:function created(){header.insertAdjacentHTML("beforeend","<div id=\"submenu\"></div>")},mounted:function mounted(){var _this=this;this.getData(),document.querySelector("body").addEventListener("touchstart",function(event){return _this.closeDropdownHandler(event)})},beforeDestroy:function beforeDestroy(){document.querySelector("body").removeEventListener("touchstart"),window.removeEventListener("scroll",this.scrollHandler),window.removeEventListener("resize",this.resizeHandler)},methods:{getData:function getData(){var _this2=this;fetch("".concat(dir,"submenu.json")).then(function(res){return res.json()}).then(function(res){_this2.results=res.filter(function(value){return value.id===id});_this2.results.length&&(_this2.setActiveIndex(),_this2.isActive=!0,window.addEventListener("load",_this2.resizeHandler),window.addEventListener("resize",_this2.resizeHandler),_this2.results[0].anchors&&window.addEventListener("scroll",_this2.scrollHandler))})},setCurrentPage:function setCurrentPage(text){text&&!text.match(/首頁$/)&&(this.currentPage=text)},setActiveIndex:function setActiveIndex(){var _this3=this;this.results[0].menus.forEach(function(menu,index){var url=menu.url.replace(/(.html|.htm)/g,"");if(url===page||url===page+hash)_this3.activeIndex=index,_this3.setCurrentPage(menu.text);else if(menu.dropdowns)return menu.dropdowns.some(function(dropdown){if(dropdown.url===page+hash)return _this3.activeIndex=index,_this3.setCurrentPage(dropdown.text),!0})})},setTitle:function setTitle(value){return this.currentPage?"".concat(value," / ").concat(this.currentPage):value},linkTo:function linkTo(url,target){var urlArr=url.split("#");if(""===urlArr[0]||urlArr[0]===page){var $target=$("#".concat(urlArr[1]));if($target.length){var targetPos=$target.offset().top;$("html, body").animate({scrollTop:targetPos-50})}}else target?window.open(url,target):window.open(url,"_self")},getScrollPos:function getScrollPos(el,offset,callback){if($(el).length){var scrollTop=$(window).scrollTop(),target=$(el).offset().top-offset;scrollTop>=target&&callback()}},scrollHandler:function scrollHandler(){var _this4=this,anchors=this.results[0].anchors,offset=this.submenu.offsetHeight;anchors.forEach(function(item){_this4.getScrollPos(item.url,offset,function(){$(_this4.submenu).addClass("active").find(".page-submenu-list > li").removeClass("active").eq(item.index).addClass("active")})})},openDropdown:function openDropdown(event){$(event.target).parents("li").addClass("is-open").siblings().removeClass("is-open")},closeDropdownHandler:function closeDropdownHandler(event){1!==$(event.target).parents(".page-submenubox").length&&$(".page-submenu-list > li").removeClass("is-open")},resizeHandler:function resizeHandler(){var menuHeight=this.submenu.offsetHeight,main=document.querySelector("main");null===main||(main.style.paddingTop=50<menuHeight?"50px":0)}},template:"\n            <div class=\"page-submenubox\" :class=\"{active:isActive}\">\n                <div class=\"page-submenu\">\n                    <div class=\"container\">\n                        <template v-for=\"result in results\">\n                            <h2>{{setTitle(result.title)}}</h2>\n                            <ul class=\"page-submenu-list\">\n                                <li v-for=\"(menu, index) in result.menus\">\n                                    <span :class=\"{active:index===activeIndex}\">\n                                        <a :href=\"menu.url\" @click.prevent=\"linkTo(menu.url, menu.target)\" @touchstart=\"openDropdown\">{{menu.text}}</a>\n                                    </span>\n                                    <ul v-if=\"menu.dropdowns\" class=\"page-submenu-dropdown\">\n                                        <li v-for=\"dropdown in menu.dropdowns\">\n                                            <a :href=\"dropdown.url\" @click.prevent=\"linkTo(dropdown.url, dropdown.target)\">{{dropdown.text}}</a>\n                                        </li>\n                                    </ul>\n                                </li>\n                            </ul>\n                        </template>\n                    </div>\n                </div>\n            </div>\n        "})})();
