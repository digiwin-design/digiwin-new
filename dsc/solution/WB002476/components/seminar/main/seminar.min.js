'use strict';

module.exports = {
    props: ['content'],
    computed: {
        isMobile: function isMobile() {
            return store.state.isMobile;
        }
    },
    watch: {
        isMobile: function isMobile(value) {
            // mobile->desktop時預設展開第一項
            if (!value) {
                $(this.$refs.accordion).find('h2').eq(0).addClass('active').next().slideDown().end().siblings('h2').removeClass('active').next().slideUp();
            }
        }
    },
    methods: {
        slideToggle: function slideToggle(event) {
            var $target = event.target.nodeName === 'H2' ? $(event.target) : $(event.target).parents('h2');
            $target.toggleClass('active').next().slideToggle();

            if (!this.isMobile) {
                $target.siblings('h2').removeClass('active').next().slideUp();
            }
        },
        clickHandler: function clickHandler(event) {
            var delay = $(event.target).data('delay');
            this.scrollHandler(event, delay);
        },
        clickHandlerOnMobile: function clickHandlerOnMobile(event) {
            this.scrollHandler(event);
        },
        scrollHandler: function scrollHandler(event) {
            var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
            // 展開/收合
            $(event.target.hash).addClass('active').next().slideDown();

            if (!this.isMobile) {
                $(event.target.hash).siblings('h2').removeClass('active').next().slideUp();
            } // 滾動頁面


            var $target = $(event.target);
            var target = $target.attr('href') || $target.data('target');
            setTimeout(function () {
                var offset = $('.page-submenu').outerHeight();
                var targetPos = $(target).offset().top;
                var finalPos = offset ? targetPos - offset : targetPos;
                $('html, body').animate({
                    scrollTop: finalPos
                });
            }, delay);
        }
    },
    mounted: function mounted() {
        $(this.$refs.accordion).find('h2').eq(0).addClass('active');
    }
};